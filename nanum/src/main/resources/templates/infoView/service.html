<!DOCTYPE html>
<html lang="ko"
    xmlns:th="http://thymeleaf.org"
    xmlns:sec="http://thymeleaf.org/extras/spring-security"
>
<head>
    <!-- 메타데이터 설정 -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>에코나비 - 환경 보호 플랫폼</title>

    <!-- jQuery 라이브러리 추가 -->
    <script th:src="@{/js/jquery-3.7.1.min.js}"></script>
    <!-- 스타일 시트 제거됨 -->
</head>
<body>
    <!-- 헤더 섹션 시작 -->
    <header>
        <h1>🌍 함께 만드는 지속 가능한 미래, 에코나비와 함께하세요</h1>
        <p>
            작은 실천이 큰 변화를 만듭니다.
            에코나비는 물품 나눔과 정확한 분리수거 정보를 통해 누구나 손쉽게 환경 보호에 동참할 수 있는 혁신적인 플랫폼입니다. 우리의 작은 발걸음이 지구를 위한 거대한 도약이 될 수 있도록, 지금 바로 에코나비와 함께하세요.
        </p>
    </header>
    <!-- 헤더 섹션 끝 -->

    <!-- 내비게이션 바 시작 -->
    <nav>
        <!-- 각 섹션으로 이동할 수 있는 링크들 -->
        <a href="#project-intro">프로젝트 소개</a>
        <a href="#service-features">서비스 기능</a>
        <a href="#team">팀원 소개</a>
        <a href="#value">서비스의 가치</a>
        <a href="#faq">FAQ</a>
        <a href="#contact">문의하기</a>
    </nav>
    <!-- 내비게이션 바 끝 -->

    <!-- 메인 콘텐츠 시작 -->
    <main>
        <!-- 프로젝트 소개 섹션 시작 -->
        <section id="project-intro">
            <h2>🌱 팀 프로젝트 소개</h2>
            <p>
                현대 사회에서 환경 오염과 자원 낭비는 인류가 직면한 가장 시급한 문제 중 하나입니다. 많은 사람들이 환경 보호의 중요성을 인식하고 있지만, 어떻게 실천해야 할지 몰라 막막함을 느끼고 있습니다. 이러한 고민에서 출발한 에코나비는 일상 속에서 누구나 쉽게 참여할 수 있는 환경 보호 방법을 제시하고자 합니다.
            </p>

            <h3>🎯 기획 의도 및 기대 효과</h3>
            <ul>
                <li><strong>실천 가능한 환경 보호</strong>: 복잡한 절차나 큰 노력이 필요하지 않은, 일상 속에서 바로 실천할 수 있는 방법을 제공합니다.</li>
                <li><strong>자원 순환의 활성화</strong>: 사용하지 않는 물품을 나누고 재사용하여 자원의 낭비를 줄이고, 폐기물 발생을 최소화합니다.</li>
                <li><strong>환경 교육과 인식 제고</strong>: 정확하고 최신의 분리수거 정보를 제공하여 올바른 환경 지식을 습득하고, 환경 보호 의식을 높입니다.</li>
                <li><strong>지역 사회의 연대 강화</strong>: 지역 기반의 나눔 활동을 통해 이웃과의 소통을 촉진하고, 공동체 의식을 함양합니다.</li>
            </ul>
        </section>
        <!-- 프로젝트 소개 섹션 끝 -->

        <!-- 서비스 기능 섹션 시작 -->
        <section id="service-features">
            <h2>🚀 서비스 기능</h2>

            <!-- 버려요 기능 소개 -->
            <h3>1. 버려요</h3>
            <p>
                환경 보호는 올바른 분리수거에서 시작됩니다.
                '버려요' 기능은 사용자가 버리고자 하는 물품의 정확한 분리수거 방법과 주의사항을 제공합니다.
            </p>
            <ul>
                <li><strong>간편한 검색 기능</strong>: 버리려는 물품의 이름이나 종류를 검색하여 분리수거 방법을 손쉽게 확인할 수 있습니다.</li>
                <li><strong>카테고리별 정보 제공</strong>: 전자제품, 플라스틱, 종이 등 다양한 품목의 분리수거 방법을 체계적으로 제공합니다.</li>
                <li><strong>실시간 정보 업데이트</strong>: 최신 분리수거 규정을 반영하여 항상 정확하고 신뢰할 수 있는 정보를 제공합니다.</li>
            </ul>

            <!-- 나눠요 기능 소개 -->
            <h3>2. 나눠요</h3>
            <p>
                당신의 작은 나눔이 누군가에게는 큰 행복이 됩니다.
                '나눠요' 기능을 통해 사용하지 않는 물품을 기부하거나 필요한 물품을 무료로 나눔받을 수 있습니다.
            </p>
            <ul>
                <li><strong>지역 기반 나눔 서비스</strong>: 위치 정보를 활용하여 가까운 지역에서 손쉽게 나눔을 실천할 수 있습니다.</li>
                <li><strong>지도 연동 게시글</strong>: 지도 상에 나눔 장소를 표시하여 주변의 나눔 활동을 쉽게 확인하고 참여할 수 있습니다.</li>
                <li><strong>커뮤니티 소통 강화</strong>: 나눔을 통해 이웃과 교류하며, 함께 환경 보호에 앞장설 수 있습니다.</li>
            </ul>

            <!-- 마이페이지 기능 소개 -->
            <h3>3. 마이페이지</h3>
            <p>
                나만의 친환경 생활 관리 시스템으로, 개인의 환경 보호 활동을 한곳에서 관리하고 성취감을 느껴보세요.
            </p>
            <ul>
                <li><strong>프로필 및 설정 관리</strong>: 개인 정보를 안전하게 관리하고, 환경 보호 목표를 설정할 수 있습니다.</li>
                <li><strong>나눔 활동 추적</strong>: 내가 나눔한 물품과 받은 물품, 관심 등록한 내역을 확인하여 나의 자원 순환 활동을 모니터링할 수 있습니다.</li>
                <li><strong>배출일 알림 서비스</strong>: 거주 지역의 쓰레기 배출 요일을 설정하면 배출일에 맞춰 알림을 받아볼 수 있습니다.</li>
            </ul>
        </section>
        <!-- 서비스 기능 섹션 끝 -->

        <!-- 지도 섹션 시작 -->
        <section id="map-section">
            <h2>나눔 장소 지도</h2>
            <!-- 지도를 표시할 영역 -->
            <div id="map" class="map-container" style="width: 100vw; height: 40vh"></div>
            <!-- Kakao Map API 스크립트 추가 -->
            <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=488efa68a7500b0e2b513a8253d1f0c9&libraries=clusterer"></script>
            <!-- 지도 관련 스크립트 시작 -->
            <script>
                // 지도 표시를 위한 JavaScript 코드

                // 지도를 표시할 div와 옵션 설정
                let mapContainer = document.getElementById('map'), // 지도를 표시할 div
                    mapOption = { 
                        center: new kakao.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
                        level: 7 // 지도의 확대 레벨
                    };

                // 지도를 생성합니다
                let map = new kakao.maps.Map(mapContainer, mapOption); 

                // 마커 클러스터러를 생성합니다 (지도에 표시할 마커 배열을 비워둠)
                let clusterer = new kakao.maps.MarkerClusterer({
                    map: map, // 마커들을 클러스터로 관리할 지도 객체
                    averageCenter: true, // 클러스터의 중심을 마커들의 평균 좌표로 설정
                    minLevel: 4, // 최소 레벨로 클러스터링을 적용
                    disableClickZoom: false // 클러스터 클릭 시 확대하는 기본 동작을 비활성화
                });


                // 내 위치 가져오기
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        function(position) {
                            let lat = position.coords.latitude; // 위도
                            let lon = position.coords.longitude; // 경도
                            let locPosition = new kakao.maps.LatLng(lat, lon);
                            console.log(lat, lon, locPosition);
                            // 지도 중심을 내 위치로 이동
                            map.setCenter(locPosition);
                        },
                        function(error) {
                            switch (error.code) {
                                case error.PERMISSION_DENIED:
                                    alert("주소창의 ! 버튼을 눌려 위치 정보를 동의해 주세요.");
                                    break;
                                case error.POSITION_UNAVAILABLE:
                                    alert("위치 정보를 사용할 수 없습니다.");
                                    break;
                                case error.TIMEOUT:
                                    alert("위치 정보를 가져오는 데 시간이 초과되었습니다.");
                                    break;
                                case error.UNKNOWN_ERROR:
                                    alert("알 수 없는 오류가 발생했습니다.");
                                    break;
                            }
                        }
                    );
                } else {
                    alert("Geolocation을 지원하지 않는 브라우저입니다.");
                }


                // 마커를 저장할 배열
                let markers = [];
                let openInfoWindow = null; // 열린 인포윈도우를 추적

                // 지도에 이벤트 등록 (idle, dragend, zoom_changed)
                kakao.maps.event.addListener(map, 'idle', function () {
                    triggerAjax(); // idle 이벤트 발생 시 마커를 불러옵니다.
                    kakao.maps.event.removeListener(map, 'idle'); // 중복 실행 방지
                });

                kakao.maps.event.addListener(map, 'dragend', function() {
                    triggerAjax(); // 지도 드래그 종료 시 마커 업데이트
                });

                kakao.maps.event.addListener(map, 'zoom_changed', function() {
                    triggerAjax(); // 지도 줌 변경 시 마커 업데이트
                });

                // 지도 영역 내의 게시글을 불러오는 AJAX 함수
                function triggerAjax() {
                    // 지도의 현재 영역을 가져옵니다.
                    let bounds = map.getBounds();
                    let swLat = bounds.getSouthWest().getLat(); // 남서쪽 위도
                    let swLng = bounds.getSouthWest().getLng(); // 남서쪽 경도
                    let neLat = bounds.getNorthEast().getLat(); // 북동쪽 위도
                    let neLng = bounds.getNorthEast().getLng(); // 북동쪽 경도

                    // 데이터에 위도, 경도 정보를 담습니다.
                    let data = {swLat: swLat, swLng: swLng, neLat: neLat, neLng: neLng};

                    // AJAX 요청을 보냅니다.
                    $.ajax({
                        url: '/share/serviceList',
                        type: 'get',
                        data: data,
                        success: function(mapList) {
                            // 기존 마커와 클러스터를 초기화합니다.
                            clusterer.clear();
                            markers = [];

                            // 마커를 생성하고 배열에 저장합니다.
                            mapList.forEach(function(share) {
                                let markerPosition = new kakao.maps.LatLng(share.shareLat, share.shareLng);

                                // 마커 중복 확인 후 생성
                                if (!isMarkerExists(markerPosition)) {
                                    let marker = new kakao.maps.Marker({
                                        position: markerPosition
                                    });
                                    marker.setMap(map);    // 마커를 지도에 표시합니다.
                                    markers.push(marker);  // 마커를 배열에 추가합니다.

                                    // 마커에 인포윈도우와 이벤트를 등록합니다.
                                    createMarkerWithInfo(marker, share);
                                }
                            });

                            // 클러스터러에 마커를 추가합니다.
                            clusterer.addMarkers(markers);
                            removeMarkersOutOfBounds(); // 경계 밖 마커 제거
                        }              
                    });
                }

                // 마커에 인포윈도우를 매칭하고 이벤트를 등록하는 함수
                function createMarkerWithInfo(marker, share) {
                    let iwContent = `
                        <div style="padding:5px; width:110px; height:150px;">
                            <span>${share.shareTitle}</span><br>
                            <span>${share.memberNickname}</span>
                            <img style="width:100px; height:100px;" src="/share/download?imageNum=${share.imageList[0].imageNum}" alt="${share.shareTitle}">
                        </div>
                    `;

                    // 인포윈도우를 생성합니다.
                    let infoWindow = new kakao.maps.InfoWindow({
                        content: iwContent,
                        disableAutoPan: true // 자동 이동 비활성화
                    });

                    // 마커에 마우스 이벤트를 등록합니다.
                    kakao.maps.event.addListener(marker, 'mouseover', function () {
                        // 다른 인포윈도우가 열려 있으면 닫습니다.
                        if (openInfoWindow) {
                            openInfoWindow.close();
                        }
                        // 인포윈도우를 마커 위에 표시합니다.
                        infoWindow.open(map, marker);
                        openInfoWindow = infoWindow;
                    });

                    kakao.maps.event.addListener(marker, 'mouseout', function () {
                        // 마우스 아웃 시 인포윈도우를 닫습니다.
                        infoWindow.close();
                        openInfoWindow = null;
                    });
                }

                // 마커 중복 여부를 확인하는 함수
                function isMarkerExists(position) {
                    return markers.some(function(marker) {
                        let markerPosition = marker.getPosition();
                        return markerPosition.getLat() === position.getLat() && markerPosition.getLng() === position.getLng();
                    });
                }

                // 지도 경계 밖의 마커를 제거하는 함수
                function removeMarkersOutOfBounds() {
                    let bounds = map.getBounds(); // 지도의 현재 경계를 가져옵니다.

                    // 경계 밖의 마커를 필터링하여 제거합니다.
                    markers = markers.filter(function(marker) {
                        let position = marker.getPosition();
                        if (bounds.contain(position)) {
                            return true;  // 경계 안에 있으면 유지
                        } else {
                            marker.setMap(null);  // 지도에서 제거
                            return false; // 배열에서 제거
                        }
                    });

                    // 클러스터러를 업데이트합니다.
                    clusterer.clear();
                    clusterer.addMarkers(markers);
                }

                // 지도 이벤트에 마커 제거 함수를 등록합니다.
                kakao.maps.event.addListener(map, 'dragend', removeMarkersOutOfBounds);
                kakao.maps.event.addListener(map, 'zoom_changed', removeMarkersOutOfBounds);
            </script>
            <!-- 지도 관련 스크립트 끝 -->
        </section>
        <!-- 지도 섹션 끝 -->

        <!-- 팀원 소개 섹션 시작 -->
        <section id="team">
            <h2>👥 팀원 소개</h2>
            <ul>
                <li><strong>김상하 (팀장)</strong>: '버려요', '마이페이지' 기능 메인 개발자<br>
                    프로젝트의 방향성을 제시하고 팀을 이끌며, 서비스의 핵심 기능을 구현하였습니다.</li>
                <li><strong>최현영</strong>: '버려요', '마이페이지' 기능 서브 메인 개발자<br>
                    사용자 경험을 개선하고, 기능 개발 및 유지 보수를 담당하였습니다.</li>
                <li><strong>정용원</strong>: '나눠요' 기능 서브 개발자 및 일본어 번역 담당<br>
                    글로벌 사용자를 위한 언어 지원과 나눔 기능 개발을 맡고 있습니다.</li>
                <li><strong>이연규</strong>: '나눠요' 기능 서브 개발자<br>
                    위치 기반 나눔 기능을 설계하고, 사용자 인터페이스를 최적화하여 편의성을 높입니다.</li>
                <li><strong>신혜리</strong>: 서비스 전반 디자인 총괄<br>
                    히어로 이미지 제작 및 '버려요' 관련 그래픽 디자인을 통해 서비스의 비주얼 아이덴티티를 강화합니다.</li>
                <li><strong>김재현</strong>: 프로젝트 기획 및 서비스 효과 분석 담당<br>
                    프로젝트의 기획 의도를 명확히 하고, 발표 준비 및 질의응답(Q&A)을 총괄하여 프로젝트의 완성도를 높입니다.</li>
            </ul>
        </section>
        <!-- 팀원 소개 섹션 끝 -->

        <!-- 서비스의 가치 섹션 시작 -->
        <section id="value">
            <h2>💡 서비스의 가치</h2>
            <ul>
                <li><strong>지속 가능한 미래를 위한 동행</strong>: 작은 행동 하나하나가 모여 큰 변화를 만듭니다.<br>
                    에코나비는 개인의 일상 속 실천이 지구의 미래를 밝게 만든다는 믿음으로 시작되었습니다. 우리의 플랫폼을 통해 환경 보호를 생활화하고, 지속 가능한 미래를 함께 만들어갑니다.</li>
                <li><strong>사용자 중심의 편의성 극대화</strong>: 누구나 쉽게 사용할 수 있도록 직관적인 UI/UX를 구현하였습니다.<br>
                    복잡한 절차 없이 환경 보호에 동참할 수 있다는 것을 직접 경험해보세요.</li>
                <li><strong>따뜻한 커뮤니티 형성</strong>: 지역 기반의 나눔을 통해 이웃과의 소통을 활성화하고, 함께 성장하는 지속 가능한 커뮤니티를 만들어갑니다.</li>
            </ul>
        </section>
        <!-- 서비스의 가치 섹션 끝 -->

        <!-- FAQ 섹션 시작 -->
        <section id="faq">
            <h2>❓ 자주 묻는 질문 (FAQ)</h2>
            <dl>
                <dt>1. 회원가입 시 필요한 정보는 무엇인가요?</dt>
                <dd>
                    • 아이디, 비밀번호, 닉네임, 이메일 주소가 필요합니다. 안전한 회원 관리를 위해 이메일 인증 절차를 거칩니다.
                </dd>

                <dt>2. 나눔은 어떻게 진행되나요?</dt>
                <dd>
                    • 나눔하고자 하는 물품을 등록하면, 위치 기반 서비스를 통해 주변의 사용자들이 해당 물품을 확인하고 신청할 수 있습니다.
                </dd>

                <dt>3. 분리수거 정보는 어떻게 확인할 수 있나요?</dt>
                <dd>
                    • '버려요' 메뉴에서 버리고자 하는 물품을 검색하면, 해당 물품의 분리수거 방법과 주의사항을 자세히 안내받을 수 있습니다.
                </dd>
            </dl>
        </section>
        <!-- FAQ 섹션 끝 -->

        <!-- 문의하기 섹션 시작 -->
        <section id="contact">
            <h2>📞 문의하기</h2>
            <p>
                서비스에 대한 궁금한 사항이나 불편 사항이 있으시면 언제든지 문의해 주세요.
                에코나비는 여러분의 소중한 의견을 통해 더욱 발전하고 성장할 것입니다.
            </p>
            <ul>
                <li><strong>전화번호</strong>: 010-XXXX-XXXX</li>
                <li><strong>이메일</strong>: <a href="mailto:support@econavi.com" class="email-link">support@econavi.com</a></li>
            </ul>
        </section>
        <!-- 문의하기 섹션 끝 -->

        <!-- 마무리 인사 섹션 추가 -->
        <section id="closing">
            <h2>🙏 마무리 인사</h2>
            <p>
                에코나비와 함께하는 작은 실천이 지구의 내일을 바꿀 수 있습니다.
                지금 바로 시작하세요!
            </p>
        </section>
        <!-- 마무리 인사 섹션 끝 -->
    </main>
    <!-- 메인 콘텐츠 끝 -->

    <!-- 푸터 섹션 시작 -->
    <footer>
        <p>&copy; 2024 에코나비 - 환경 보호 플랫폼. All rights reserved.</p>
    </footer>
    <!-- 푸터 섹션 끝 -->

</body>
</html>
